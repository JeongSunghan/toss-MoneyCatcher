/**
 * config.js - 게임 설정 및 상수 관리
 * 
 * 게임의 모든 설정값과 상수를 중앙에서 관리합니다.
 * 레벨별 난이도 데이터도 자동으로 생성합니다.
 */
(() => {
  "use strict";

  window.Game = window.Game || {};
  
  // ============================================
  // 게임 기본 설정
  // ============================================
  Game.config = {
    WORLD_WIDTH: 360,        // 게임 월드 너비
    WORLD_HEIGHT: 520,       // 게임 월드 높이
    MAX_LEVEL: 10,           // 최대 레벨
    LEVEL_SCORE_INTERVAL: 10000, // 레벨업에 필요한 금액 간격 (10000원마다 레벨업)
    COMBO_DURATION: 3.0,      // 콤보 유지 시간 (초)
    FEVER_DURATION: 7.0,      // FEVER 타임 지속 시간 (초)
    MAX_HEARTS: 5,            // 최대 생명 수
    
    // 아이템별 금액 (음수는 감점)
    SCORE: {
      cash10: 10,        // 10원
      cash50: 50,        // 50원
      cash100: 100,      // 100원
      cash500: 500,      // 500원
      cash1000: 1000,    // 1000원
      cash5000: 5000,    // 5000원
      cash10000: 10000,  // 10000원
      cash50000: 50000,  // 50000원
      tax: 0,            // 세금 (퍼센트 차감으로 처리)
      debt: 0,           // 빚 (퍼센트 차감으로 처리)
    },
    
    // 아이템별 색상
    COLOR: {
      cash10: "#D4AF37",     // 금색
      cash50: "#C0C0C0",     // 은색
      cash100: "#51CF66",    // 초록색
      cash500: "#B87333",    // 구리색
      cash1000: "#4ECDC4",   // 청록색
      cash5000: "#FFE66D",   // 노란색
      cash10000: "#FFA500",  // 주황색
      cash50000: "#FF6B6B",  // 빨간색
      tax: "#FF6B6B",       // 빨간색
      debt: "#8B6F47",      // 갈색
    },
    
    // 아이템별 표시 라벨
    LABEL: {
      cash10: "10",
      cash50: "50",
      cash100: "100",
      cash500: "500",
      cash1000: "1K",
      cash5000: "5K",
      cash10000: "10K",
      cash50000: "50K",
      tax: "TAX",
      debt: "DEBT",
    },
    
    // 레벨별 아이템 스폰 가중치 [타입, 가중치]
    // 레벨에 따라 다른 가중치를 반환하는 함수
    getWeightsByLevel(level) {
      // level은 1-based (1~10)
      if (level <= 2) {
        // 1~2레벨: 작은 금액 위주 (10원, 50원, 100원, 500원, 1000원)
        return [
          ["cash10", 20],
          ["cash50", 20],
          ["cash100", 20],
          ["cash500", 15],
          ["cash1000", 15],
          ["tax", 14],
          ["debt", 10],
        ];
      } else if (level <= 5) {
        // 3~5레벨: 중간 금액 추가 (5000원, 10000원 드랍하지만 비율이 현저히 적음)
        return [
          ["cash50", 15],
          ["cash100", 20],
          ["cash500", 15],
          ["cash1000", 20],
          ["cash5000", 8],
          ["cash10000", 4],
          ["tax", 14],
          ["debt", 10],
        ];
      } else if (level <= 8) {
        // 6~8레벨: 중간 금액이 평균 (5000원, 10000원이 평균)
        return [
          ["cash100", 10],
          ["cash500", 10],
          ["cash1000", 15],
          ["cash5000", 30],
          ["cash10000", 20],
          ["tax", 14],
          ["debt", 10],
        ];
      } else {
        // 9~10레벨: 큰 금액 위주 (5000원, 10000원 평균, 50000원 낮은 확률)
        return [
          ["cash1000", 5],
          ["cash5000", 35],
          ["cash10000", 35],
          ["cash50000", 5],
          ["tax", 14],
          ["debt", 10],
        ];
      }
    },
  };
  
  // ============================================
  // 아이템 타입 상수
  // ============================================
  Game.ITEM = {
    CASH10: "cash10",
    CASH50: "cash50",
    CASH100: "cash100",
    CASH500: "cash500",
    CASH1000: "cash1000",
    CASH5000: "cash5000",
    CASH10000: "cash10000",
    CASH50000: "cash50000",
    TAX: "tax",
    DEBT: "debt",
  };
  
  // ============================================
  // 레벨별 난이도 데이터 생성
  // ============================================
  Game.LEVELS = [];
  for (let i = 1; i <= Game.config.MAX_LEVEL; i++) {
    // 레벨이 올라갈수록:
    // - 스폰 간격 감소 (더 빠른 스폰)
    // - 중력 증가 (더 빠른 낙하)
    // - 최대 속도 증가 (더 빠른 낙하)
    const baseSpawn = 700 - (i - 1) * 50;        // 스폰 간격 (ms)
    const baseG = 0.0006 + (i - 1) * 0.00005;   // 중력 가속도
    const baseMaxSpeed = 0.38 + (i - 1) * 0.02; // 최대 낙하 속도
    
    Game.LEVELS.push({
      id: i,
      spawn: Math.max(400, baseSpawn),      // 최소 400ms
      g: Math.min(0.0012, baseG),           // 최대 0.0012
      maxSpeed: Math.min(0.65, baseMaxSpeed), // 최대 0.65
    });
  }
  
  console.log("[Config] 게임 설정 로드 완료");
})();

